function initFullPage(){"use strict";$(document).ready(function(){$("#fullpage").fullpage({sectionsColor:["#fff","#ccdcff","#7BAABE","whitesmoke","#ccddff"],resize:!1,anchors:["home","login"],navigation:!1,navigationTooltips:["Welcome","Login"]});var t=$("input");t.on("keydown",function(e){if(9===e.which&&e.shiftKey){e.preventDefault();var i=t.get(t.index(this)-1);i?i.focus():t[1].focus()}})})}function TooltipCustom(){var t=function(t){var i;$("div.custom-tooltip").remove(),i=$(this).data("tooltip"),setTimeout(function(){$('<div class="custom-tooltip"><span id="tip-icon" class="glyphicons glyphicons-lightbulb"></span>'+i+"</div>").appendTo("body").addClass("animated-tt bounceIn"),e(t)},200)},e=function(t){var e=t.clientX+$(window).scrollLeft(),i=t.clientY-45+$(window).scrollTop();$("div.custom-tooltip").css({top:i,left:e})},i=function(){$("div.custom-tooltip").remove()};$(".tooltip-item").bind({mousemove:e,mouseenter:t,mouseleave:i})}function timeToSeconds(t){"use strict";return t=t.split(/:/),3600*t[0]+60*t[1]}function secToString(t){"use strict";return 0===t.length?0:t>60&&3600>=t?Math.floor(t/60)+" minutes":t>3600&&86400>=t?Math.floor(t/3600)+" hours":void 0}function secondsToTime(t){"use strict";var e,i;return e=Math.floor(t/3600),t-=3600*e,i=Math.floor(t/60),t-=60*i,e+":"+(10>i?"0"+i:i)}function datelimits(){"use strict";var t,e,i,a,n,r,o,s;t=$(".logDataCol span#week").text(),e=timeToSeconds(t),i=$(".logDataCol span#day").text(),a=timeToSeconds(i),n=(28800-e)/60,r=(7200-a)/60,o=secondsToTime(28800-e),7200===a&&28800===e?($('button#submitact[type="submit"]').attr("disabled","disabled"),$("span#week, span#day").css("color","#f27264"),$("#time_slider2").slider("option","disabled",!0)):a>=7200?($('button#submitact[type="submit"]').attr("disabled","disabled"),$("span#day").css("color","#f27264"),$("#time_slider2").slider("option","disabled",!0)):e>=28800?($('button#submitact[type="submit"]').attr("disabled","disabled"),$("span#week, span#day").css("color","#f27264"),$("#time_slider2").slider("option","disabled",!0)):(s=r>n?n:r,$("#time_slider2").slider({max:s}),$("#time_slider2").slider("pips"),$("#time_val").attr("value","00:15:00"),$("#time_value").text("00:15:00"),$('button#submitact[type="submit"]').removeAttr("disabled"),$("#time_slider2").slider("option","disabled",!1),$("span#week, span#day").css("color","#7de0ae"))}function getTime(t){"use strict";$.ajax({type:"GET",url:"/activitycheck/"+t,success:function(t){var e,i;e=secondsToTime(t.weektotal[0].weekTotal),i=secondsToTime(t.daytotal[0].DayTotal),$("span#day").text(i),$("span#week").text(e),datelimits()}})}function GoalStartDate(){"use strict";$.ajax({type:"GET",url:"/goal/start_date",success:function(t){var e,i,a,n,r,o;e=new Date(t.date),i=e.getFullYear(),a=e.getMonth()+1,n=e.getDate()+1,r=a+"/"+n+","+i,o=$(document).find(".hasDatepicker"),$(o).datepicker("option",{minDate:new Date(r)})}})}function checkIE(){"use strict";var t=!1;$("html").is(".badIE")&&(t=!0),t&&window.location.replace("/error")}function checkWeight(t){"use strict";$.ajax({type:"GET",url:"/weightcheck/"+t,success:function(t){0!==t.length?$("button#weight_submit").prop("disabled",!0):$("button#weight_submit").prop("disabled",!1)}})}function Cardover(){"use strict";$(this).children(".hovercard").fadeIn("slow");var t=$(this).data("url");$.ajax({type:"GET",data:t,dataType:"json",url:"/hovercard/"+t,success:function(t){var e,i;e=new Date(t.created_at.date.replace(/-/g,"/")),i=e.getFullYear(),$(".hovercard").html('<span class="hovercard-bg"><img id="team-bg" src="../img/teams/default.png"><img class="img-circle" id="profileImg" src=../'+t.pic+'></span><div class="row-centered" style="top:92px; position:relative"><h4 class="col-md-12">'+t.userFirst+" "+t.userLast+'</h4></div><div class="row-centered" style="top:80px; position:relative"><div id="memberDate" class="col-md-3"><div id="bar-col-1" class="glyphicon glyphicon-calendar"></div><div>'+t.year+'</div></div><div id="memberDate" class="col-md-3"><div id="bar-col-2" class="glyphicon glyphicon-time"></div><div>'+t.time+'</div></div><div id="memberDate" class="col-md-3"><div id="bar-col-4" class="glyphicon glyphicon-stats"></div><div>'+t.activities+'</div></div><div id="memberDate" class="col-md-3"><div id="glyph-hover-points" class="glyphicons glyphicons-star"></div><div><span id="progress"><div class="bar" id="team-reward" style="width: '+t.ptpercentage+'%"></div></span></div></div></div><!-- End of Row-->')}})}function Cardout(){"use strict";$(this).children(".hovercard").hide()}function initHoverCard(){"use strict";$('span[rel="hovercard"]').hoverIntent({over:Cardover,out:Cardout,interval:200,timeout:200})}function logForm(){"use strict";function t(){var t,e,i,a,n,r,o,s,c,l;return t="01",e="06",a="31",n="05",o=new Date,s=o.getMonth(),c=o.getFullYear(),s>=0&&4>=s?(i=c-1,r=c):(i=c,r=c+1),l=e+"/"+t+","+i}function e(t){var e=Math.floor(t.value/60),i=t.value-60*e;0===i&&(i="00"),1===e.length&&(e="0"+e),1===i.length&&(i="0"+i),$("#time_val").val("0"+e+":"+i+":00"),$("#time_value").text("0"+e+":"+i+":00")}function i(){var t,e,i;switch(t=$("#time_value").text(),e=$(".btn-group-xs label.active").children("input").attr("value"),i=2,t){case"00:15:00":i=1*e;break;case"00:30:00":i=2*e;break;case"00:45:00":i=3*e;break;case"01:00:00":i=4*e;break;case"01:15:00":i=5*e;break;case"01:30:00":i=6*e;break;case"01:45:00":i=7*e;break;case"02:00:00":i=8*e;break;default:i=0}$("#points_value").text(i),$("#points_hidden").val(i)}var a=["Hiking","Yoga","Zumba","P90X","Kick Boxing","Swimming","Yard Work","Walk Dog","Gardening","Weight Training","Elliptical","Calisthenics","Disc Golf","Jogging","Basketball"];$("#activity_text_input").autocomplete({source:a}),$("#points_hidden").attr("value","2"),$(".intensity label.btn").click(function(t){$(this).addClass("current").siblings().removeClass("active"),t.preventDefault();var e,i,a;switch(e=$("#time_value").text(),i=$(this).children("input").val(),$(".intensity input#hiddenintensity").val(i),a=0,e){case"00:15:00":a=i;break;case"00:30:00":a=2*i;break;case"00:45:00":a=3*i;break;case"01:00:00":a=4*i;break;case"01:15:00":a=5*i;break;case"01:30:00":a=6*i;break;case"01:45:00":a=7*i;break;case"02:00:00":a=8*i;break;default:a=0}$("#points_value").text(a),$("#points_hidden").val(a)}),$("#activity_datepicker").datepicker({showOn:"button",buttonImage:"../img/calendar-blk.png",buttonImageOnly:!0,dateFormat:"yy-mm-dd",altField:"#activity_datepicker",altFormat:"yy-mm-dd",minDate:new Date(t()),maxDate:new Date,beforeSend:function(){},complete:function(){},onSelect:function(){var t,e,i,a,n;t=new Date(Date.parse($(this).datepicker("getDate"))),e=$.datepicker.formatDate("yy-mm-dd",t),i=$.datepicker.formatDate("MM d, yy",t),$("#date_value").text(i),$("#time_slider2").slider({value:15}),$.ajax({type:"GET",url:"activitycheck/"+e,success:function(t){a=secondsToTime(t.weektotal[0].weekTotal),n=secondsToTime(t.daytotal[0].DayTotal),$("span#day").text(n),$("span#week").text(a),datelimits()}})}});var n=($("#activity_datepicker").datepicker("setDate",new Date),$("#activity_datepicker").prop("value"));getTime(n),$("#time_slider2").slider({min:15,max:120,step:15,change:function(t,a){e(a),i()},slide:function(t,a){e(a),i()}}),$("#time_slider2").slider("pips"),$("button#submitact").click(function(t){t.preventDefault();var e,i,a,n,r,o,s,c;e=$("#activity_datepicker").prop("value"),i=$("#time_val").val(),a=$("#hiddenintensity").val(),n=$("#activity_text_input").prop("value"),r=$("#points_hidden").prop("value"),o="time",s="actdate="+e+"&acttime="+i+"&actintensity="+a+"&factpt="+r+"&actname="+n+"&type="+o,c=jQuery.timeago(new Date),$.ajax({type:"POST",url:"activity/"+s,data:s,cache:!1,dataType:"json",beforeSend:function(){$("button#submitact").prop("disabled",!0),NProgress.configure({showSpinner:!1}),NProgress.start()},complete:function(){},success:function(t){setTimeout(function(){if(NProgress.done(),t.success===!0){t.badge&&($("div#modal-badge-data").html("<h4>"+t.name+"</h4><img src='/assets/img/badges/"+t.image+"'> <p>Level "+t.lvl+" : "+t.goal+" hrs</p>"),$("#badgeModal").modal({show:!0})),getTime(e),$("#activity_datepicker").datepicker("setDate",new Date),$("span#date_value").text("Today"),$("input#activity_text_input").val(""),$("#time_slider2").slider("value",$("#time_slider2").slider("option","min")),$("span#time_value").text("00:15:00"),$("#time_val").val("00:15:00"),$(".intensity").find(".active").removeClass("active"),$(".intensity label.moderate").addClass("active"),$("input#hiddenintensity").val("2"),$("input#points_hidden").val("2"),$("span#points_value").text("2");var i=$("#activity_datepicker").prop("value");getTime(i),$("button#submitact").prop("disabled",!1)}else $.each(t,function(t,e){var i;i="<div id='dash-side-right' class='alert alert-custom'>",i+="<button type='button' class='close' data-dismiss='alert'>x</button>",i+="<ul class='log_errors'>",i+="<li>"+e+"</li></ul></div>",$("div.headbar").after(i)})},3e3)}})})}function ActivityFilter(){"use strict";$("div.activity-type label.btn").on("click",function(){var t,e;$(".activity-type label.btn").attr("disabled","disabled"),NProgress.configure({showSpinner:!1,speed:400}),NProgress.start(),e=$(this).find("input").val(),$.get("/activity-filter/"+e,function(){$(".recentActivity").find("*").not(".recentheader, .recentheader *, li#more, .load-more *").remove()}).done(function(e){var i=e.user;setTimeout(function(){NProgress.done(),$.each(e.activities,function(t,e){var a,n,r,o,s;a=e.user,n=new Date(e.created_at.replace(/-/g,"/")),r=n.toISOString(),o="<div id='recent_activity_container' class='col-md-8 col-sm-11 col-centered' >",o+="<li id='"+e.id+"'>",o+="<div class='activityBox'>",o+="<div class='recentActivityDesc'>",o+="<div class='profilePicContainer'>",o+="<span rel='hovercard' data-url="+e.user_id+"><div class='hovercard'></div>",o+="<img id='profilePic' src=../"+a.pic+" /></span></div>",o+="<div class='recentActivityName'>"+a.first_name+" "+a.last_name.charAt(0)+". </div>",e.user.badgeuser.length>0&&(s=e.user.badgeuser[0],o+="<div id='container-flair'>",o+="<span class='sprite-flair_"+s.type+"_"+s.lvl+" tooltip-item' data-tooltip='"+s.desc+"'></span>",o+="</div>",$("div#container-flair span").tooltip({placement:"bottom"})),o+="time"===e.type?"<div class='recentActivityText'>Logged "+secToString(timeToSeconds(e.activity_time))+" of <strong>"+e.activity_name+" </strong></div></div>":"read"===e.type?"<div class='recentActivityText'>Read <a href='/blog'>"+e.activity_name+" </a></div></div>":"<div class='recentActivityText'>"+e.activity_name+"</div></div>",o+="<div class='activityStatsContainer'>",o+="<div class='timeContainer'><span class='glyphicon glyphicon-time'></span><abbr class='timeago' title='"+r+"'>&nbsp;</abbr></div>",i!==e.user_id&&0===e.likes.length?(o+="<div class='toLikeImg'>",o+="<div class='glyphicon glyphicon-heart like-heart tooltip-item' id='"+e.id+"' data-tooltip='Click to like!'></div>",o+="</div>"):(o+="<div class='activityLikeImg' id='"+e.id+"'>",o+="<span class='glyphicon glyphicon-heart' style='color:#F563A1'></span>",o+="<span class='like-count'>&nbsp;"+e.likeCount+"</span>",o+="</div>"),o+="",o+="</div>",o+="time"===e.type?"<div class='activityIcon'><img src='/img/timeActivity.png'/></div>":"read"===e.type?"<div class='activityIcon'><img src='/img/readActivity.png'/></div>":"<div class='activityIcon'><img src='/img/goalActivity.png'/></div>",o+="</div></li></div>",$(o).appendTo("ul.recentActivity").hide().slideDown("slow",function(){$("li.activityItem, img#ajaximg").animate({opacity:"1"},800)})}),$(".activity-type label.btn").removeAttr("disabled"),jQuery("abbr.timeago").timeago(),initHoverCard(),TooltipCustom(),t+=10;var a=$.isEmptyObject(e);a===!0?$("li#more").remove():($("li#more").appendTo($("ul.recentActivity")),$("li#more").attr("num_loaded",10))},1e3)})})}function Like(){"use strict";$(".like-heart").on("click",function(){var t=parseInt($(this).attr("id"),10);return $.ajax({type:"POST",data:t,dataType:"json",url:"applaud/"+t,success:function(e){var i,a;i=e.newCount,$("#"+t+".like-heart").hide(),0===$("#"+t+".activityLikeImg").length&&$("li#"+t+" .activityStatsContainer").append("<div class='activityLikeImg'><span class='glyphicon glyphicon-heart' style='color:#F563A1'></span><span class='like-count'></span></div>"),$("#"+t+" .like-count").fadeOut("slow",function(){$("#"+t+" .like-count").html("&nbsp;"+i),$("#"+t+" .like-count").fadeIn("slow")}),a=$("div#glyph-text.likes").data("count"),a+=1,$("div#glyph-text.likes").data("count",a),$("div#glyph-text.likes").html(a)},error:function(){}}),!1})}function ActivityHover(){"use strict";$(".recentActivity li").hoverIntent(function(){$(this).children("div.timeContainer").animate({color:"rgba(255, 152, 0, 0.4)"},350,!1),$(this).find(".activityIcon img").animate({"background-color":"rgba(255, 152, 0, 0.4)"},350,!1)},function(){$(this).children("div.timeContainer").animate({color:"rgba(255, 255, 255, 0.34)"},350,!1),$(this).find(".activityIcon img").animate({"background-color":"rgba(0, 0, 0, 0)"},350,!1)})}function weightChallengeDataEntry(){"use strict";var t=$.fn.popover.Constructor.prototype.show;$.fn.popover.Constructor.prototype.show=function(){t.call(this),this.options.callback&&this.options.callback()},$(".popover-markup>.trigger").popover({html:!0,title:function(){return $(this).parent().find(".head").html()},content:function(){return $(this).parent().find(".content").html()},callback:function(){$("button#weight_submit").click(function(t){t.preventDefault();var e,i,a,n,r,o;return e=$("#weight_datepicker").prop("value"),i=$("input#weight").prop("value"),a=/^\d{2,3}(\.\d{1})?$/,n=a.test(i),""===e||""===i||n===!1?void r("Please enter a valid weight and date"):(o={date:e,weight:i},void $.ajax({type:"POST",url:"/goalstore/"+o,data:o,cache:!1,dataType:"json",success:function(t){t.badge&&(weightChart.updateChart(),$(".popover-markup>.trigger").popover("hide"),$("div#modal-badge-data").html("<h4>"+t.name+"</h4><img src='/assets/img/badges/"+t.image+"'> <p>Level "+t.lvl+" : "+t.goal+" lbs</p>"),$("#badgeModal").modal({show:!0})),weightChart.updateChart(),$(".popover-markup>.trigger").popover("hide"),$("span#weight_data").text(t.weight_lost)},error:function(){}}))}),$("#weight_datepicker").datepicker({showOn:"button",buttonImage:"/img/calendar-blk.png",buttonImageOnly:!0,dateFormat:"yy-mm-dd",altField:"#weight_datepicker",altFormat:"yy-mm-dd",defaultDate:new Date,maxDate:new Date,onSelect:function(){var t,e,i;t=new Date(Date.parse($(this).datepicker("getDate"))),e=$.datepicker.formatDate("yy-mm-dd",t),i=$.datepicker.formatDate("MM d, yy",t),$("#date_value").text(i),checkWeight(e)}}),$("#weight_datepicker").datepicker("setDate",new Date);var t=$("#weight_datepicker").prop("value");checkWeight(t),GoalStartDate()}}).click(function(t){t.preventDefault()})}function ActivityPagination(){"use strict";$("li#more.load-more").on("click",function(t){t.stopPropagation(),t.preventDefault();var e=$(".activity-type label.active input").attr("value"),i=$(this).attr("num_loaded");i=parseInt(i,10),$.ajax({url:"/activities_pag/",data:{filter:e,load:i},dataType:"json",type:"post",success:function(t){var e=t.userid;$.each(t.activities,function(t,i){var a=i.user,n=new Date(i.created_at.replace(/-/g,"/")),r=n.toISOString(),o="<div id='recent_activity_container' class='col-md-8 col-sm-11 col-centered' >";if(o+="<li id='"+i.id+"'>",o+="<div class='activityBox'>",o+="<div class='recentActivityDesc'>",o+="<div class='profilePicContainer'>",o+="<span rel='hovercard' data-url="+i.user_id+"><div class='hovercard'></div>",o+="<img id='profilePic' src=../"+a.pic+" /></span></div>",o+="<div class='recentActivityName'>"+a.first_name+" "+a.last_name.charAt(0)+". </div>",i.user.badgeuser.length>0){var s=i.user.badgeuser[0];o+="<div id='container-flair'>",o+="<span class='sprite-flair_"+s.type+"_"+s.lvl+" tooltip-item' data-tooltip='"+s.desc+"'></span>",o+="</div>",$("div#container-flair span").tooltip({placement:"bottom"})}o+="time"===i.type?"<div class='recentActivityText'>Logged "+secToString(timeToSeconds(i.activity_time))+" of <strong>"+i.activity_name+" </strong></div></div>":"read"===i.type?"<div class='recentActivityText'>Read <a href='/blog'>"+i.activity_name+" </a></div></div>":"<div class='recentActivityText'>"+i.activity_name+"</div></div>",o+="<div class='activityStatsContainer'>",o+="<div class='timeContainer'><span class='glyphicon glyphicon-time'></span><abbr class='timeago' title='"+r+"'>&nbsp;</abbr></div>",e!==i.user_id&&0===i.likes.length?(o+="<div class='toLikeImg'>",o+="<div class='glyphicon glyphicon-heart like-heart tooltip-item' id='"+i.id+"' data-tooltip='Click to like!'></div>",o+="</div>"):(o+="<div class='activityLikeImg' id='"+i.id+"'>",o+="<span class='glyphicon glyphicon-heart' style='color:#F563A1'></span>",o+="<span class='like-count'>&nbsp;"+i.likeCount+"</span>",o+="</div>"),o+="",o+="</div>",o+="time"===i.type?"<div class='activityIcon'><img src='/img/timeActivity.png'/></div>":"read"===i.type?"<div class='activityIcon'><img src='/img/readActivity.png'/></div>":"<div class='activityIcon'><img src='/img/goalActivity.png'/></div>",o+="</div></li></div>",$(o).appendTo("ul.recentActivity").hide().slideDown("slow",function(){$("li.activityItem, img#ajaximg").animate({opacity:"1"},600)})}),$("abbr.timeago").timeago(),initHoverCard(),TooltipCustom(),i+=10;var a=$.isEmptyObject(t);a===!0?$("li#more").remove():($("li#more").appendTo($("ul.recentActivity")),$("li#more").attr("num_loaded",i))}})})}function activityChart(){"use strict";var t=window.location.href.split("/");d3.xhr("/user-activity/"+t[4],function(t){t=JSON.parse(t.responseText);var e=d3.scale.category10(),i={top:20,right:20,bottom:30,left:30},a=630,n=250,r=d3.time.format("%b");t.forEach(function(t){t.forEach(function(t){t.month_number=d3.time.format("%m").parse(""+ +t.month_number),t.month_number=r(t.month_number),t.time=+t.time})});{var o=d3.select("body").append("div").attr("class","tooltip").attr("id","chart-tooltip").style("opacity",0),s=d3.scale.linear().domain([0,40]).range([n,0]),c=d3.svg.axis().scale(s).orient("left").innerTickSize(-a).outerTickSize(0).tickPadding(10),l=d3.scale.ordinal().domain(["Jun","Jul","Aug","Sep","Oct","Nov","Dec","Jan","Feb","Mar","Apr","May"]).rangePoints([0,a]),d=d3.svg.axis().scale(l).orient("bottom").innerTickSize(-n).outerTickSize(0).tickPadding(10),p=d3.svg.line().x(function(t){return l(t.month_number)}).y(function(t){return s(t.time)}),u=d3.select("#chart-container").append("svg").attr("width","100%").attr("height","100%").attr("preserveAspectRatio","xMinYMin").attr("viewBox","0 0 700 300").append("g").attr("transform","translate("+i.left+","+i.top+")");u.append("text").attr("x",a/2).attr("y",0-i.top/2).attr("text-anchor","middle").style("font-size","1.3em").style("text-decoration","underline").text("Time: Current Year vs Last Year")}if(u.append("g").attr("class","x axis").attr("transform","translate(0,"+n+")").call(d),u.append("g").attr("class","y axis").call(c),t[0].length>0){var v=u.selectAll(".line").data(t),m=v.enter().append("g").attr("class","time").attr("id",function(t){return t.name}),g=m.append("path").attr("class","line").attr("d",p).attr("stroke-width",2).style("stroke",function(t){return e(t[0].name)});m.append("g").selectAll(".dot").data(function(t){return t}).enter().append("circle").style("stroke",function(){return e(this.parentNode.__data__[0].name)}).attr("class","datapoint").on("mouseover",function(t){o.transition().duration(100).style("opacity",.9),o.html(this.parentNode.__data__[0].name+" Year <br />"+t.time+" hrs").style("left",d3.event.pageX+"px").style("top",d3.event.pageY-28+"px").attr("r",8),d3.select(this).attr("r",8)}).on("mouseout",function(){o.transition().duration(100).style("opacity",0),d3.select(this).attr("r",5)}).attr("r",3.5).attr("fill","white").attr("fill-opacity",.5).attr("cx",function(t){return l(t.month_number)}).attr("cy",function(t){return s(t.time)}),m.append("text").attr("class","names").datum(function(t){return{name:t[0].name,time:t[0].time,month_number:t[t.length-1].month_number}}).attr("transform",function(t){return"translate("+l(t.month_number)+","+s(t.time)+")"}).attr("x",4).text(function(t){return t.name});var h=g.node().getTotalLength();g.attr("stroke-dasharray",h+" "+h).attr("stroke-dashoffset",h).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",0)}})}function weightChart(){function t(){return d3.svg.axis().scale(s).orient("bottom").ticks(5)}function e(){return d3.svg.axis().scale(c).orient("left").ticks(5)}function i(){var i=window.location.href.split("/");d3.xhr("/user-weight/"+i[4],function(i){i=JSON.parse(i.responseText),i.forEach(function(t){t.goal_date=d3.time.format("%Y-%m-%d").parse(t.goal_date),t.weight=+t.weight}),s.domain(d3.extent(i,function(t){return t.goal_date})),c.domain([i[i.length-1].goalline-10,d3.max(i,function(t){return t.weight})]).nice(),u.select("g.y.grid").call(e().tickSize(-n+10,0,0).tickFormat("")),u.select("g.x.grid").call(t().tickSize(-r,0,0).tickFormat(""));var a=d3.select("#chart-weight").transition();a.select(".line").duration(750).attr("d",p(i));var v=u.selectAll("circle").data(i);v.transition().attr("cx",function(t){return s(t.goal_date)}).attr("cy",function(t){return c(t.weight)}),v.enter().append("svg:circle").style("stroke","#7de0ae").on("mouseover",function(t){o.transition().duration(100).style("opacity",.9),o.html(" Weight <br />"+t.weight+" lbs").style("left",d3.event.pageX+"px").style("top",d3.event.pageY-28+"px").attr("r",8),d3.select(this).attr("r",8)}).on("mouseout",function(){o.transition().duration(100).style("opacity",0),d3.select(this).attr("r",5)}).attr("fill","white").attr("fill-opacity",.5).attr("r","3.5").attr("cx",function(t){return s(t.goal_date)}).attr("cy",function(t){return c(t.weight)}),a.select(".x.axis").duration(750).call(l).selectAll("text").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform",function(){return"rotate(-65)"}),a.select(".y.axis").duration(750).call(d)})}var a={top:5,right:30,bottom:5,left:40},n=630,r=250,o=(d3.time.format("%Y-%m-%d").parse,d3.select("body").append("div").attr("class","tooltip").style("opacity",0)),s=d3.time.scale().range([0,n-10]),c=d3.scale.linear().range([r,0]),l=d3.svg.axis().scale(s).ticks(d3.time.days,1).tickFormat(d3.time.format("%m/%d")).orient("bottom"),d=d3.svg.axis().scale(c).ticks(5).orient("left"),p=d3.svg.line().x(function(t){return s(t.goal_date)}).y(function(t){return c(t.weight)}),u=d3.select("#chart-weight").append("svg").attr("width","100%").attr("height","100%").attr("preserveAspectRatio","xMinYMin").attr("viewBox","0 0 700 300").append("g").attr("transform","translate("+a.left+","+a.top+")"),v=window.location.href.split("/");d3.xhr("/user-weight/"+v[4],function(i){if(i=JSON.parse(i.responseText),i.forEach(function(t){t.goal_date=d3.time.format("%Y-%m-%d").parse(t.goal_date),t.weight=+t.weight}),s.domain(d3.extent(i,function(t){return t.goal_date})),c.domain([i[i.length-1].goalline-15,d3.max(i,function(t){return t.weight})]).nice(),console.log(i[0].weight+5),u.append("g").attr("class","x axis").attr("transform","translate(0, "+r+")").call(l).selectAll("text").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform",function(){return"rotate(-65)"}),u.append("g").attr("class","y axis").call(d).append("text").attr("transform","rotate(-90)").attr("y",0-a.left).attr("x",0-r/2).attr("dy",".71em").style("text-anchor","middle").text("Weight (lbs)"),u.append("g").attr("class","x grid").attr("transform","translate(0,"+r+")").call(t().tickSize(-r,0,0).tickFormat("")),u.append("g").attr("class","y grid").call(e().tickSize(-n+10,0,0).tickFormat("")),console.log(i),i.length>1){u.append("path").datum(i).attr("class","line").attr("stroke-width",2).style("stroke","#7de0ae").attr("d",p);var v=u.selectAll(".goalline").data(i);v.enter().append("line").style("stroke-dasharray","3,3").style("stroke","#f2c864").attr("x1",s(s.domain()[0])).attr("x2",s(s.domain()[1])).attr("y1",function(t){return c(t.goalline)}).attr("y2",function(t){return c(t.goalline)});{var m=u.selectAll(".point").data(i);m.enter().append("svg:circle").style("stroke","#7de0ae").on("mouseover",function(t){o.transition().duration(100).style("opacity",.9),o.html(" Weight <br />"+t.weight+" lbs").style("left",d3.event.pageX+"px").style("top",d3.event.pageY-28+"px").attr("r",8),d3.select(this).attr("r",8)}).on("mouseout",function(){o.transition().duration(100).style("opacity",0),d3.select(this).attr("r",5)}).attr("fill","white").attr("fill-opacity",.5).attr("r","3.5").attr("cx",function(t){return s(t.goal_date)}).attr("cy",function(t){return c(t.weight)})}}}),weightChart.updateChart=i}$("a.navProfileLink").click(function(t){"use strict";t.preventDefault();var e=$(this).parent().attr("id");$.ajax({type:"GET",url:"user-info/"+e,success:function(){}})});