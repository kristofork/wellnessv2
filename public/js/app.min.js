function initFullPage(){$("#fullpage").fullpage({sectionsColor:["#fff","#ccdcff","#7BAABE","whitesmoke","#ccddff"],resize:!1,anchors:["home","login"],navigation:!0,navigationTooltips:["Welcome","Login"]})}function timeToSeconds(t){return t=t.split(/:/),3600*t[0]+60*t[1]}function secToString(t){return 0===t.length?0:t>60&&3600>=t?Math.floor(t/60)+" minutes":t>3600&&86400>=t?Math.floor(t/3600)+" hours":void 0}function secondsToTime(t){var e,a;return e=Math.floor(t/3600),t-=3600*e,a=Math.floor(t/60),t-=60*a,e+":"+(10>a?"0"+a:a)}function datelimits(){var t,e,a,i,n,r,s,o;t=$(".logDataCol span#week").text(),e=timeToSeconds(t),a=$(".logDataCol span#day").text(),i=timeToSeconds(a),n=(28800-e)/60,r=(7200-i)/60,s=secondsToTime(28800-e),7200===i&&28800===e?($('button#submitact[type="submit"]').attr("disabled","disabled"),$("span#week, span#day").css("color","#f27264"),$("#time_slider2").slider("option","disabled",!0)):i>=7200?($('button#submitact[type="submit"]').attr("disabled","disabled"),$("span#day").css("color","#f27264"),$("#time_slider2").slider("option","disabled",!0)):e>=28800?($('button#submitact[type="submit"]').attr("disabled","disabled"),$("span#week, span#day").css("color","#f27264"),$("#time_slider2").slider("option","disabled",!0)):(o=r>n?n:r,$("#time_slider2").slider({max:o}),$("#time_slider2").slider("pips"),$("#time_val").attr("value","00:15:00"),$("#time_value").text("00:15:00"),$('button#submitact[type="submit"]').removeAttr("disabled"),$("#time_slider2").slider("option","disabled",!1),$("span#week, span#day").css("color","#7de0ae"))}function getTime(t){$.ajax({type:"GET",url:"/activitycheck/"+t,success:function(t){var e,a;e=secondsToTime(t.weektotal[0].weekTotal),a=secondsToTime(t.daytotal[0].DayTotal),$("span#day").text(a),$("span#week").text(e),datelimits()}})}function goalStartDate(){var t=this;$.ajax({type:"GET",url:"/goal/start_date",success:function(e){var a,i,n,r,s,o;a=new Date(e.date),i=a.getFullYear(),n=a.getMonth()+1,r=a.getDate()+1,s=i+","+n+","+r,o=$(t.document).find(".hasDatepicker"),$(o).datepicker("option",{minDate:new Date(s)})}})}function checkIE(){var t=!1;$("html").is(".badIE")&&(t=!0),t&&window.location.replace("/error")}function checkWeight(t){$.ajax({type:"GET",url:"/weightcheck/"+t,success:function(t){0!==t.length?$("button#weight_submit").prop("disabled",!0):$("button#weight_submit").prop("disabled",!1)}})}function cardover(){$(this).children(".hovercard").fadeIn("slow");var t=$(this).data("url");$.ajax({type:"GET",data:t,dataType:"json",url:"/hovercard/"+t,success:function(t){var e,a;e=new Date(t.created_at.date.replace(/-/g,"/")),a=e.getFullYear(),$(".hovercard").html('<span class="hovercard-bg"><img id="team-bg" src="../assets/img/teams/blur2.png"><img class="img-circle" id="profileImg" src='+t.pic+'></span><div class="row-centered" style="top:92px; position:relative"><h4 class="col-md-12">'+t.userFirst+" "+t.userLast+'</h4></div><div class="row-centered" style="top:80px; position:relative"><div id="memberDate" class="col-md-3"><div class="glyphicon glyphicon-calendar"></div><div>'+t.year+'</div></div><div id="memberDate" class="col-md-3"><div class="glyphicon glyphicon-time"></div><div>'+t.time+'</div></div><div id="memberDate" class="col-md-3"><div class="glyphicon glyphicon-stats"></div><div>'+t.activities+'</div></div><div id="memberDate" class="col-md-3"><div id="glyph-hover-points" class="glyphicons glyphicons-star"></div><div><span id="progress"><div class="bar" id="team-reward" style="width: 10%">10%</div></span></div></div></div><!-- End of Row-->')}})}function cardout(){$(this).children(".hovercard").hide()}function initHoverCard(){$('span[rel="hovercard"]').hoverIntent({over:cardover,out:cardout,interval:200,timeout:200})}function logForm(){function t(){var t,e,a,i,n,r,s,o,c;t=1,e=6,a=0,i=31,n=5,r=0,s=new Date,o=s.getMonth(),c=s.getFullYear(),o>=0&&4>=o?(a=c-1,r=c):(a=c,r=c+1);var l=a+","+e+","+t;return l}function e(t){var e=Math.floor(t.value/60),a=t.value-60*e;0===a&&(a="00"),1===e.length&&(e="0"+e),1===a.length&&(a="0"+a),$("#time_val").val("0"+e+":"+a+":00"),$("#time_value").text("0"+e+":"+a+":00")}function a(){var t,e,a;switch(t=$("#time_value").text(),e=$(".btn-group-xs label.active").children("input").attr("value"),a=2,t){case"00:15:00":a=1*e;break;case"00:30:00":a=2*e;break;case"00:45:00":a=3*e;break;case"01:00:00":a=4*e;break;case"01:15:00":a=5*e;break;case"01:30:00":a=6*e;break;case"01:45:00":a=7*e;break;case"02:00:00":a=8*e;break;default:a=0}$("#points_value").text(a),$("#points_hidden").val(a)}var i=["Hiking","Yoga","Zumba","P90X","Kick Boxing","Swimming","Yard Work","Walk Dog","Gardening","Weight Training","Elliptical","Calisthenics","Disc Golf","Jogging","Basketball"];$("#activity_text_input").autocomplete({source:i}),$("#points_hidden").attr("value","2"),$(".intensity label.btn").click(function(t){$(this).addClass("current").siblings().removeClass("active"),t.preventDefault();var e,a,i;switch(e=$("#time_value").text(),a=$(this).children("input").val(),$(".intensity input#hiddenintensity").val(a),i=0,e){case"00:15:00":i=1*a;break;case"00:30:00":i=2*a;break;case"00:45:00":i=3*a;break;case"01:00:00":i=4*a;break;case"01:15:00":i=5*a;break;case"01:30:00":i=6*a;break;case"01:45:00":i=7*a;break;case"02:00:00":i=8*a;break;default:i=0}$("#points_value").text(i),$("#points_hidden").val(i)}),$("#activity_datepicker").datepicker({showOn:"button",buttonImage:"../assets/img/site/calendar-blk.png",buttonImageOnly:!0,dateFormat:"yy-mm-dd",altField:"#activity_datepicker",altFormat:"yy-mm-dd",minDate:new Date(t()),maxDate:new Date,beforeSend:function(){},complete:function(){},onSelect:function(){var t,e,a;t=new Date(Date.parse($(this).datepicker("getDate"))),e=$.datepicker.formatDate("yy-mm-dd",t),a=$.datepicker.formatDate("MM d, yy",t),$("#date_value").text(a),$("#time_slider2").slider({value:15}),$.ajax({type:"GET",url:"activitycheck/"+e,success:function(t){var e=secondsToTime(t.weektotal[0].weekTotal),a=secondsToTime(t.daytotal[0].DayTotal);$("span#day").text(a),$("span#week").text(e),datelimits()}})}});var n=($("#activity_datepicker").datepicker("setDate",new Date),$("#activity_datepicker").prop("value"));getTime(n),$("#time_slider2").slider({min:15,max:120,step:15,change:function(t,i){e(i),a()},slide:function(t,i){e(i),a()}}),$("#time_slider2").slider("pips"),$("button#submitact").click(function(t){t.preventDefault();var e,a,i,n,r,s,o,c;e=$("#activity_datepicker").prop("value"),a=$("#time_val").val(),i=$("#hiddenintensity").val(),n=$("#activity_text_input").prop("value"),r=$("#points_hidden").prop("value"),s="time",o="actdate="+e+"&acttime="+a+"&actintensity="+i+"&factpt="+r+"&actname="+n+"&type="+s,c=jQuery.timeago(new Date),$.ajax({type:"POST",url:"activity/"+o,data:o,cache:!1,dataType:"json",beforeSend:function(){$("button#submitact").prop("disabled",!0),NProgress.configure({showSpinner:!1}),NProgress.start()},complete:function(){},success:function(t){setTimeout(function(){if(NProgress.done(),t.success===!0){t.badge&&($("div#modal-badge-data").html("<h4>"+t.name+"</h4><img src='/assets/img/badges/"+t.image+"'> <p>Level "+t.lvl+" : "+t.goal+" hrs</p>"),$("#badgeModal").modal({show:!0})),getTime(e),$("#activity_datepicker").datepicker("setDate",new Date),$("span#date_value").text("Today"),$("input#activity_text_input").val(""),$("#time_slider2").slider("value",$("#time_slider2").slider("option","min")),$("span#time_value").text("00:15:00"),$("#time_val").val("00:15:00"),$(".intensity").find(".active").removeClass("active"),$(".intensity label.moderate").addClass("active"),$("input#hiddenintensity").val("2"),$("input#points_hidden").val("2"),$("span#points_value").text("2");var a=$("#activity_datepicker").prop("value");getTime(a),$("button#submitact").prop("disabled",!1)}else $.each(t,function(t,e){var a;a="<div id='dash-side-right' class='alert alert-custom'>",a+="<button type='button' class='close' data-dismiss='alert'>x</button>",a+="<ul class='log_errors'>",a+="<li>"+e+"</li></ul></div>",$("div.headbar").after(a)})},5e3)}})})}function ActivityFilter(){$("div.activity-type label.btn").on("click",function(){var t,e;$(".activity-type label.btn").attr("disabled","disabled"),t=$(this).attr("num_loaded"),t=parseInt(t,10),NProgress.configure({showSpinner:!1,speed:400}),NProgress.start(),e=$(this).find("input").val(),$.get("/activity-filter/"+e,function(){$(".recentActivity").find("*").not(".recentheader, .recentheader *").remove()}).done(function(e){var a=e.user;setTimeout(function(){NProgress.done(),$.each(e.activities,function(t,e){var i,n,r,s;if(i=e.user,n=new Date(e.created_at.replace(/-/g,"/")),r=n.toISOString(),s="<div id='recent_activity_container' class='col-md-8 col-sm-11 col-centered' >",s+="<li id='"+e.id+"'>",s+="<div class='activityBox'>",s+="<div class='recentActivityDesc'>",s+="<div class='profilePicContainer'>",s+="<span rel='hovercard' data-url="+e.user_id+"><div class='hovercard'></div>",s+="<img id='profilePic' src=/"+i.pic+" /></span></div>",s+="<div class='recentActivityName'>"+i.first_name+" "+i.last_name.charAt(0)+". </div>",e.user.badgeuser.length>0){var o=e.user.badgeuser[0];s+="<div id='container-flair'>",s+="<span class='sprite-flair_"+o.type+"_"+o.lvl+"' title='"+o.desc+"'></span>",s+="</div>",$("div#container-flair span").tooltip({placement:"bottom"})}s+="time"===e.type?"<div class='recentActivityText'>Logged "+secToString(timeToSeconds(e.activity_time))+" of <strong>"+e.activity_name+" </strong></div></div>":"read"===e.type?"<div class='recentActivityText'>Read <a href='/blog'>"+e.activity_name+" </a></div></div>":"<div class='recentActivityText'>"+e.activity_name+"</div></div>",s+="<div class='activityStatsContainer'>",s+="<div class='timeContainer'><span class='glyphicon glyphicon-time'></span><abbr class='timeago' title='"+r+"'>&nbsp;</abbr></div>",a!==e.user_id&&0===e.likes.length?(s+="<div class='toLikeImg'>",s+="<div class='glyphicon glyphicon-heart like-heart' id='"+e.id+"' title='Click to like!'></div>",s+="</div>"):(s+="<div class='activityLikeImg' id='"+e.id+"'>",s+="<span class='glyphicon glyphicon-heart' style='color:#F563A1'></span>",s+="<span class='like-count'>&nbsp;"+e.likeCount+"</span>",s+="</div>"),s+="",s+="</div>",s+="time"===e.type?"<div class='activityIcon'><img src='/assets/img/badges/timeActivity.png'/></div>":"read"===e.type?"<div class='activityIcon'><img src='/assets/img/badges/readActivity.png'/></div>":"<div class='activityIcon'><img src='/assets/img/badges/goalActivity.png'/></div>",s+="</div></li></div>",$(s).appendTo("ul.recentActivity").hide().slideDown("slow",function(){$("li.activityItem, img#ajaximg").animate({opacity:"1"},800)})}),$(".activity-type label.btn").removeAttr("disabled")},1e3),jQuery("abbr.timeago").timeago(),initHoverCard(),t+=10;var i=$.isEmptyObject(e);i===!0?$("li#more").remove():($("li#more").appendTo($("ul.recentActivity")),$("li#more").attr("num_loaded",t))})})}function Like(){$(".like-heart").on("click",function(){var t=parseInt($(this).attr("id"));return $.ajax({type:"POST",data:t,dataType:"json",url:"applaud/"+t,success:function(e){countnum=e.newCount,$("#"+t+".like-heart").hide(),console.log($("#"+t+".activityLikeImg").length),0==$("#"+t+".activityLikeImg").length&&$("li#"+t+" .activityStatsContainer").append("<div class='activityLikeImg'><span class='glyphicon glyphicon-heart' style='color:#FF5566'></span><span class='like-count'></span></div>"),$("#"+t+" .like-count").fadeOut("slow",function(){$("#"+t+" .like-count").html("&nbsp;"+countnum),$("#"+t+" .like-count").fadeIn("slow")});var a=$("div#glyph-text.likes").data("count");a+=1,$("div#glyph-text.likes").data("count",a),$("div#glyph-text.likes").html(a)},error:function(t){console.log(t.responseText)}}),!1})}function ActivityHover(){$(".recentActivity li").hoverIntent(function(){$(this).children("div.timeContainer").animate({color:"rgba(255, 152, 0, 0.4)"},350,!1),$(this).find(".activityIcon img").animate({"background-color":"rgba(255, 152, 0, 0.4)"},350,!1)},function(){$(this).children("div.timeContainer").animate({color:"rgba(255, 255, 255, 0.34)"},350,!1),$(this).find(".activityIcon img").animate({"background-color":"rgba(0, 0, 0, 0)"},350,!1)})}function weightChallengeDataEntry(){var t=$.fn.popover.Constructor.prototype.show;$.fn.popover.Constructor.prototype.show=function(){t.call(this),this.options.callback&&this.options.callback()},$(".popover-markup>.trigger").popover({html:!0,title:function(){return $(this).parent().find(".head").html()},content:function(){return $(this).parent().find(".content").html()},callback:function(){$("button#weight_submit").click(function(t){t.preventDefault();var e=$("#weight_datepicker").prop("value"),a=$("input#weight").prop("value"),i=/^\d{2,3}(\.\d{1})?$/,n=i.test(a);if(""==e||""==a||n===!1)return void alert("Please enter a valid weight and date");var r={date:e,weight:a};$.ajax({type:"POST",url:"/goalstore/"+r,data:r,cache:!1,dataType:"json",success:function(t){t.badge&&(weightChart.updateChart(),$(".popover-markup>.trigger").popover("hide"),$("div#modal-badge-data").html("<h4>"+t.name+"</h4><img src='/assets/img/badges/"+t.image+"'> <p>Level "+t.lvl+" : "+t.goal+" lbs</p>"),$("#badgeModal").modal({show:!0})),weightChart.updateChart(),$(".popover-markup>.trigger").popover("hide"),$("span#weight_data").text(t.weight_lost)},error:function(t){console.log(t)}})}),$("#weight_datepicker").datepicker({showOn:"button",buttonImage:"../assets/img/site/calendar-blk.png",buttonImageOnly:!0,dateFormat:"yy-mm-dd",altField:"#weight_datepicker",altFormat:"yy-mm-dd",defaultDate:new Date,maxDate:new Date,onSelect:function(){var t=new Date(Date.parse($(this).datepicker("getDate"))),e=$.datepicker.formatDate("yy-mm-dd",t),a=$.datepicker.formatDate("MM d, yy",t);$("#date_value").text(a),checkWeight(e)}}),$("#weight_datepicker").datepicker("setDate",new Date);var t=$("#weight_datepicker").prop("value");checkWeight(t),goalStartDate()}}).click(function(t){t.preventDefault()})}function ActivityPagination(){$("li#more.load-more").on("click",function(t){t.stopPropagation(),t.preventDefault();var e=$(".activity-type label.active input").attr("value"),a=$(this).attr("num_loaded"),a=parseInt(a);$.ajax({url:"/activities_pag/",data:{filter:e,load:a},dataType:"json",type:"post",success:function(t){var e=t.userid;$.each(t.activities,function(t,a){var i=a.user,n=new Date(a.created_at.replace(/-/g,"/")),r=n.toISOString(),s="<div id='recent_activity_container' class='col-md-8 col-sm-11 col-centered' >";if(s+="<li id='"+a.id+"'>",s+="<div class='activityBox'>",s+="<div class='recentActivityDesc'>",s+="<div class='profilePicContainer'>",s+="<span rel='hovercard' data-url="+a.user_id+"><div class='hovercard'></div>",s+="<img id='profilePic' src="+i.pic+" /></span></div>",s+="<div class='recentActivityName'>"+i.first_name+" "+i.last_name.charAt(0)+". </div>",a.user.badgeuser.length>0){var o=a.user.badgeuser[0];s+="<div id='container-flair'>",s+="<span class='sprite-flair_"+o.type+"_"+o.lvl+"' title='"+o.desc+"'></span>",s+="</div>",$("div#container-flair span").tooltip({placement:"bottom"})}s+="time"==a.type?"<div class='recentActivityText'>Logged "+secToString(timeToSeconds(a.activity_time))+" of <strong>"+a.activity_name+" </strong></div></div>":"read"==a.type?"<div class='recentActivityText'>Read <a href='/blog'>"+a.activity_name+" </a></div></div>":"<div class='recentActivityText'>"+a.activity_name+"</div></div>",s+="<div class='activityStatsContainer'>",s+="<div class='timeContainer'><span class='glyphicon glyphicon-time'></span><abbr class='timeago' title='"+r+"'>&nbsp;</abbr></div>",e!=a.user_id&&0==a.likes.length?(s+="<div class='toLikeImg'>",s+="<div class='glyphicon glyphicon-heart like-heart' id='"+a.id+"' title='Click to like!'></div>",s+="</div>"):(s+="<div class='activityLikeImg' id='"+a.id+"'>",s+="<span class='glyphicon glyphicon-heart' style='color:#F563A1'></span>",s+="<span class='like-count'>&nbsp;"+a.likeCount+"</span>",s+="</div>"),s+="",s+="</div>",s+="time"==a.type?"<div class='activityIcon'><img src='/assets/img/badges/timeActivity.png'/></div>":"read"==a.type?"<div class='activityIcon'><img src='/assets/img/badges/readActivity.png'/></div>":"<div class='activityIcon'><img src='/assets/img/badges/goalActivity.png'/></div>",s+="</div></li></div>",$(s).appendTo("ul.recentActivity").hide().slideDown("slow",function(){$("li.activityItem, img#ajaximg").animate({opacity:"1"},600)})}),$("abbr.timeago").timeago(),initHoverCard(),a+=10;var i=$.isEmptyObject(t);1==i?$("li#more").remove():($("li#more").appendTo($("ul.recentActivity")),$("li#more").attr("num_loaded",a))}})})}function activityChart(){var t=window.location.href.split("/");d3.xhr("/user-activity/"+t[4],function(t){t=JSON.parse(t.responseText),console.log(t.length);var e=d3.scale.category10(),a={top:20,right:20,bottom:30,left:30},i=630,n=250,r=d3.time.format("%b");t.forEach(function(t){t.forEach(function(t){t.month_number=d3.time.format("%m").parse(""+ +t.month_number),t.month_number=r(t.month_number),t.time=+t.time})});{var s=d3.select("body").append("div").attr("class","tooltip").attr("id","chart-tooltip").style("opacity",0),o=d3.scale.linear().domain([0,40]).range([n,0]),c=d3.svg.axis().scale(o).orient("left").innerTickSize(-i).outerTickSize(0).tickPadding(10),l=d3.scale.ordinal().domain(["Jun","Jul","Aug","Sep","Oct","Nov","Dec","Jan","Feb","Mar","Apr","May"]).rangePoints([0,i]),d=d3.svg.axis().scale(l).orient("bottom").innerTickSize(-n).outerTickSize(0).tickPadding(10),p=d3.svg.line().x(function(t){return l(t.month_number)}).y(function(t){return o(t.time)}),v=d3.select("#chart-container").append("svg").attr("preserveAspectRatio","xMinYMin").attr("viewBox","0 0 700 300").append("g").attr("transform","translate("+a.left+","+a.top+")");v.append("text").attr("x",i/2).attr("y",0-a.top/2).attr("text-anchor","middle").style("font-size","1.3em").style("text-decoration","underline").text("Time: Current Year vs Last Year")}if(v.append("g").attr("class","x axis").attr("transform","translate(0,"+n+")").call(d),v.append("g").attr("class","y axis").call(c),t[0].length>0){var u=v.selectAll(".line").data(t),m=u.enter().append("g").attr("class","time").attr("id",function(t){return t.name}),g=m.append("path").attr("class","line").attr("d",p).attr("stroke-width",2).style("stroke",function(t){return e(t[0].name)});m.append("g").selectAll(".dot").data(function(t){return t}).enter().append("circle").style("stroke",function(){return e(this.parentNode.__data__[0].name)}).attr("class","datapoint").on("mouseover",function(t){s.transition().duration(100).style("opacity",.9),s.html(this.parentNode.__data__[0].name+" Year <br />"+t.time+" hrs").style("left",d3.event.pageX+"px").style("top",d3.event.pageY-28+"px").attr("r",8),d3.select(this).attr("r",8)}).on("mouseout",function(){s.transition().duration(100).style("opacity",0),d3.select(this).attr("r",5)}).attr("r",3.5).attr("fill","white").attr("fill-opacity",.5).attr("cx",function(t){return l(t.month_number)}).attr("cy",function(t){return o(t.time)}),m.append("text").attr("class","names").datum(function(t){return{name:t[0].name,time:t[0].time,month_number:t[t.length-1].month_number}}).attr("transform",function(t){return"translate("+l(t.month_number)+","+o(t.time)+")"}).attr("x",4).text(function(t){return t.name});var h=g.node().getTotalLength();g.attr("stroke-dasharray",h+" "+h).attr("stroke-dashoffset",h).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",0)}})}function weightChart(){function t(){return d3.svg.axis().scale(o).orient("bottom").ticks(5)}function e(){return d3.svg.axis().scale(c).orient("left").ticks(5)}function a(){var a=window.location.href.split("/");d3.xhr("/user-weight/"+a[4],function(a){a=JSON.parse(a.responseText),a.forEach(function(t){t.goal_date=d3.time.format("%Y-%m-%d").parse(t.goal_date),t.weight=+t.weight}),o.domain(d3.extent(a,function(t){return t.goal_date})),c.domain([a[a.length-1].goalline-10,d3.max(a,function(t){return t.weight})]).nice(),v.select("g.y.grid").call(e().tickSize(-n+10,0,0).tickFormat("")),v.select("g.x.grid").call(t().tickSize(-r,0,0).tickFormat(""));var i=d3.select("#chart-weight").transition();i.select(".line").duration(750).attr("d",p(a));var u=v.selectAll("circle").data(a);u.transition().attr("cx",function(t){return o(t.goal_date)}).attr("cy",function(t){return c(t.weight)}),u.enter().append("svg:circle").style("stroke","#7de0ae").on("mouseover",function(t){s.transition().duration(100).style("opacity",.9),s.html(" Weight <br />"+t.weight+" lbs").style("left",d3.event.pageX+"px").style("top",d3.event.pageY-28+"px").attr("r",8),d3.select(this).attr("r",8)}).on("mouseout",function(){s.transition().duration(100).style("opacity",0),d3.select(this).attr("r",5)}).attr("fill","white").attr("fill-opacity",.5).attr("r","3.5").attr("cx",function(t){return o(t.goal_date)}).attr("cy",function(t){return c(t.weight)}),i.select(".x.axis").duration(750).call(l).selectAll("text").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform",function(){return"rotate(-65)"}),i.select(".y.axis").duration(750).call(d)})}var i={top:5,right:30,bottom:5,left:40},n=630,r=250,s=(d3.time.format("%Y-%m-%d").parse,d3.select("body").append("div").attr("class","tooltip").style("opacity",0)),o=d3.time.scale().range([0,n-10]),c=d3.scale.linear().range([r,0]),l=d3.svg.axis().scale(o).ticks(d3.time.days,1).tickFormat(d3.time.format("%m/%d")).orient("bottom"),d=d3.svg.axis().scale(c).ticks(5).orient("left"),p=d3.svg.line().x(function(t){return o(t.goal_date)}).y(function(t){return c(t.weight)}),v=d3.select("#chart-weight").append("svg").attr("preserveAspectRatio","xMinYMin").attr("viewBox","0 0 700 300").append("g").attr("transform","translate("+i.left+","+i.top+")"),u=window.location.href.split("/");d3.xhr("/user-weight/"+u[4],function(a){a=JSON.parse(a.responseText),a.forEach(function(t){t.goal_date=d3.time.format("%Y-%m-%d").parse(t.goal_date),t.weight=+t.weight}),o.domain(d3.extent(a,function(t){return t.goal_date})),c.domain([a[a.length-1].goalline-10,d3.max(a,function(t){return t.weight})]).nice(),console.log(a[0].weight+5),v.append("g").attr("class","x axis").attr("transform","translate(0, "+r+")").call(l).selectAll("text").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform",function(){return"rotate(-65)"}),v.append("g").attr("class","y axis").call(d).append("text").attr("transform","rotate(-90)").attr("y",0-i.left).attr("x",0-r/2).attr("dy",".71em").style("text-anchor","middle").text("Weight (lbs)"),v.append("g").attr("class","x grid").attr("transform","translate(0,"+r+")").call(t().tickSize(-r,0,0).tickFormat("")),v.append("g").attr("class","y grid").call(e().tickSize(-n+10,0,0).tickFormat("")),v.append("path").datum(a).attr("class","line").attr("stroke-width",2).style("stroke","#7de0ae").attr("d",p);var u=v.selectAll(".goalline").data(a);u.enter().append("line").style("stroke-dasharray","3,3").style("stroke","#f2c864").attr("x1",o(o.domain()[0])).attr("x2",o(o.domain()[1])).attr("y1",function(t){return c(t.goalline)}).attr("y2",function(t){return c(t.goalline)});{var m=v.selectAll(".point").data(a);m.enter().append("svg:circle").style("stroke","#7de0ae").on("mouseover",function(t){s.transition().duration(100).style("opacity",.9),s.html(" Weight <br />"+t.weight+" lbs").style("left",d3.event.pageX+"px").style("top",d3.event.pageY-28+"px").attr("r",8),d3.select(this).attr("r",8)}).on("mouseout",function(){s.transition().duration(100).style("opacity",0),d3.select(this).attr("r",5)}).attr("fill","white").attr("fill-opacity",.5).attr("r","3.5").attr("cx",function(t){return o(t.goal_date)}).attr("cy",function(t){return c(t.weight)})}}),weightChart.updateChart=a}$("a.navProfileLink").click(function(t){t.preventDefault();var e=$(this).parent().attr("id");$.ajax({type:"GET",url:"user-info/"+e,success:function(){}})});