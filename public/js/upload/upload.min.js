jQuery(function(){function e(){$("#x").val(""),$("#y").val(""),$("#w").val(""),$("#h").val("")}$("#progress").hide(),$("#downloadBtn").hide(),$("#fileupload").fileupload({url:"upload",dataType:"json",done:function(n,i){function r(e){$("#x").val(e.x),$("#y").val(e.y),$("#w").val(e.w),$("#h").val(e.h)}$("#progress").hide(),e(),$.each(i.result.files,function(e,n){$("#files").html($("<img/>").attr("src",n)),$(".jcrop-preview").attr("src",n),$("#previewModel").modal("show")});var a,o,t;$("#files img").Jcrop({minSize:[70,70],onChange:r,onSelect:r,aspectRatio:1},function(){var e=this.getBounds();o=e[0],t=e[1],a=this})},fail:function(){alert("Error uploading an image")},always:function(){$("#progress").hide()},start:function(){$("#progress").show()},acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i,maxFileSize:5e6,maxNumberOfFiles:1,progressall:function(e,n){var i=parseInt(n.loaded/n.total*100,10);$("#progress .bar").css("width",i+"%")}});var n={lines:13,length:20,width:2,radius:12,corners:1,rotate:0,direction:1,color:"#CCC",speed:1,trail:67,shadow:!0,hwaccel:!1,className:"spinner",zIndex:2e9};ImageSpinner=new Spinner(n).spin(document.getElementById("previewSpinner")),ImageSpinner.stop(),$("#updatepicform").submit(function(){return ImageSpinner.spin(document.getElementById("previewSpinner")),$.post("previewpic",$("#updatepicform").serialize()).done(function(){location.reload()}).fail(function(){alert("error")}).always(function(){ImageSpinner.stop()}),!1})});